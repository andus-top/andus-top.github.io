<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="keywords" content="个人博客, 松林羊, ysl, songlinsheep, andus, blog, 个人站点, 个人网站"><meta name="description" content="松林羊的个人网站，用于记录，分享。欢迎交流^-^"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><title> JAVA 读取Excel(支持xlsx、xls格式， 支持合并单元格) | 松林羊</title><link rel="shortcut icon" href="/smile.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css"><script src="/js/pace.min.js"></script><script>!function(e,t,o,c,i,a,n){e.DaoVoiceObject=i,e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},e[i].l=1*new Date,a=t.createElement(o),n=t.getElementsByTagName(o)[0],a.async=1,a.src=c,a.charset="utf-8",n.parentNode.insertBefore(a,n)}(window,document,"script",("https:"==document.location.protocol?"https:":"http:")+"//widget.daovoice.io/widget/0f81ff2f.js","daovoice"),daovoice("init",{app_id:"1559132c"}),daovoice("update")</script></head></html><body><main class="content"><section class="outer"><article id="post-JAVA-读取Excel-支持xlsx、xls格式，-支持合并单元格" class="article article-type-post" itemscope itemprop="blogPost" data-scroll-reveal><div class="article-inner"><header class="article-header"><h1 class="article-title" itemprop="name"> JAVA 读取Excel(支持xlsx、xls格式， 支持合并单元格)</h1></header><div class="article-meta"> <a href="/2019/05/17/JAVA-读取Excel-支持xlsx、xls格式，-支持合并单元格/" class="article-date"><time datetime="2019-05-17T11:46:46.000Z" itemprop="datePublished">2019-05-17</time></a><div class="article-category"> <a class="article-category-link" href="/categories/编程语言/">编程语言</a></div> &emsp;<i class="fe fe-bar-chart"></i> <span class="post-count">1.8k</span>字 &emsp;<i class="fe fe-clock"></i> <span class="post-count">9</span>分钟</div><div class="article-entry" itemprop="articleBody"><p>记录一下最近使用java操作excel的代码。</p><ol><li><p>导包。注意两者版本需要一致</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>解析excel代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	 <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">         <span class="comment">// 获取输入流</span></span><br><span class="line">          InputStream in = getResourcesFileInputStream(<span class="string">"Test.xlsx"</span>);</span><br><span class="line">          <span class="comment">//InputStream in = getResourcesFileInputStream("Test.xls");</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">// 解析---1</span></span><br><span class="line">          <span class="comment">// 解析Excel所有sheet，所有行,所有列</span></span><br><span class="line">          List&lt;List&lt;String[]&gt;&gt; allData = ExcelUtil.read(in);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 解析---2</span></span><br><span class="line">          <span class="comment">// 解析第一个sheet数据</span></span><br><span class="line">          ExcelUtil.readSheet(in, <span class="number">0</span>, sheet -&gt; &#123;</span><br><span class="line">              <span class="comment">//解析第3行到最后一行，第2列到第9列的数据</span></span><br><span class="line">              List&lt;String[]&gt; source = ExcelUtil.readSheetPart(sheet, <span class="number">2</span>, sheet.getLastRowNum(), <span class="number">1</span>, <span class="number">8</span>);</span><br><span class="line">          &#125;);</span><br><span class="line"></span><br><span class="line">          <span class="comment">// 解析---3</span></span><br><span class="line">          <span class="comment">// 完全自定义解析</span></span><br><span class="line">          ExcelUtil.readByCustomize(in, wb -&gt; &#123;</span><br><span class="line">              <span class="comment">// doSomeThing()...可参照ExcelUtil.readExcel()方法</span></span><br><span class="line">          &#125;);</span><br><span class="line"></span><br><span class="line">		  in.close();</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * 加载Resources目录下的文件</span></span><br><span class="line"><span class="comment">        * <span class="doctag">@param</span> fileName 文件名</span></span><br><span class="line"><span class="comment">        * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> InputStream <span class="title">getResourcesFileInputStream</span><span class="params">(String fileName)</span></span>&#123;</span><br><span class="line">          <span class="comment">// Resources目录的绝对路径</span></span><br><span class="line">          <span class="comment">// String path = Thread.currentThread().getContextClassLoader().getResource("").getPath();</span></span><br><span class="line">          InputStream in = Thread.currentThread().getContextClassLoader().getResourceAsStream(<span class="string">""</span> + fileName);</span><br><span class="line">          <span class="keyword">return</span> in;</span><br><span class="line">	 &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><p><font color="red">注意事项</font>：<a href="https://www.jianshu.com/p/b36c9230089f" target="_blank" rel="noopener">获取的excel行数不正确解决方法</a></p><ol start="4"><li>Excel工具类<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Cell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.WorkbookFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.openxml4j.exceptions.InvalidFormatException;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.*;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellRangeAddress;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Excel工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Logger logger = LoggerFactory.getLogger(ExcelUtil.class);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对excel单个sheet进行处理的接口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">SheetHandler</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 对sheet进行处理</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">handle</span><span class="params">(Sheet sheet)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 对excel进行处理的接口</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WorkBookHandler</span> </span>&#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * 对excel进行处理</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@param</span> wb</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">handle</span><span class="params">(Workbook wb)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取excel指定sheet数据&lt;br&gt;未关闭io</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  in</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readSheet</span><span class="params">(InputStream in, <span class="keyword">int</span> sheetIdx, SheetHandler handler)</span> <span class="keyword">throws</span> IOException, InvalidFormatException </span>&#123;</span><br><span class="line">        <span class="comment">// 创建工作簿</span></span><br><span class="line">        Workbook wb = createWorkBook(in);</span><br><span class="line">        <span class="comment">// 接口回调处理</span></span><br><span class="line">        handler.handle(getSheetByIdx(wb, sheetIdx));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取excel全部sheet全部行数据&lt;br&gt;未关闭io</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  in</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> List&lt;List&lt;String[]&gt;&gt; &lt;br&gt;List&lt;String[]&gt;表示第i个sheet&lt;br&gt; String[]表示sheet某行</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;List&lt;String[]&gt;&gt; read(InputStream in) <span class="keyword">throws</span> IOException, InvalidFormatException &#123;</span><br><span class="line">        <span class="comment">// 创建工作簿</span></span><br><span class="line">        Workbook wb = createWorkBook(in);</span><br><span class="line">        <span class="comment">// 默认读取所有行，所有列</span></span><br><span class="line">        <span class="keyword">return</span> readExcel(wb);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取excel&lt;br&gt;自定义解析方式&lt;br&gt;未关闭io</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  in</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readByCustomize</span><span class="params">(InputStream in, WorkBookHandler handler)</span> <span class="keyword">throws</span> IOException, InvalidFormatException </span>&#123;</span><br><span class="line">        <span class="comment">// 创建工作簿</span></span><br><span class="line">        Workbook wb = createWorkBook(in);</span><br><span class="line"></span><br><span class="line">        handler.handle(wb);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取指定sheet的范围行，范围列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheet excel 某个sheet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> startRow 开始行下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endRow 结束行下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> startCol 开始列下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> endCol 结束列下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 指定范围的数据。一个String[]是一行数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String[]&gt; readSheetPart(Sheet sheet, <span class="keyword">int</span> startRow, <span class="keyword">int</span> endRow, <span class="keyword">int</span> startCol, <span class="keyword">int</span> endCol)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(sheet == <span class="keyword">null</span>)&#123;</span><br><span class="line">            logger.warn(<span class="string">"excel sheet is not exist"</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> firstRow = sheet.getFirstRowNum();</span><br><span class="line">        <span class="keyword">int</span> lastRow = sheet.getLastRowNum();</span><br><span class="line">        logger.info(<span class="string">"sheet firstRow:"</span>+firstRow);</span><br><span class="line">        logger.info(<span class="string">"sheet lastRow:"</span>+lastRow);</span><br><span class="line">        <span class="keyword">if</span>(startRow &lt; <span class="number">0</span> || startRow &gt; lastRow || startRow &gt; endRow)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(endRow &gt; lastRow)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        List&lt;String[]&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">// 逐行解析</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = startRow; i &lt;= endRow ; i++) &#123;</span><br><span class="line">            Row row = sheet.getRow(i);</span><br><span class="line">            <span class="comment">// 过滤空行</span></span><br><span class="line">            <span class="keyword">if</span>(row == <span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> firstCol = row.getFirstCellNum();</span><br><span class="line">            <span class="keyword">int</span> lastCol = row.getLastCellNum();</span><br><span class="line">            logger.info(<span class="string">"row("</span>+i+<span class="string">") firstCol:"</span>+firstCol);</span><br><span class="line">            logger.info(<span class="string">"row("</span>+i+<span class="string">") lastCol:"</span>+lastCol);</span><br><span class="line">            <span class="keyword">if</span>(startCol &lt; <span class="number">0</span> || startCol &gt; lastCol || startCol &gt; endCol)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(endCol &gt; lastCol)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> colIdx = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> objIdx = <span class="number">0</span>;</span><br><span class="line">            String[] objs = <span class="keyword">new</span> String[endCol-startCol+<span class="number">1</span>];</span><br><span class="line">            <span class="comment">// 逐列解析</span></span><br><span class="line">            <span class="keyword">for</span> (Cell c : row) &#123;</span><br><span class="line">                <span class="comment">// 读取指定列数据</span></span><br><span class="line">                <span class="keyword">if</span>(colIdx &gt;= startCol &amp;&amp; colIdx &lt;= endCol)&#123;</span><br><span class="line">                    c.setCellType(Cell.CELL_TYPE_STRING);</span><br><span class="line">                    <span class="keyword">boolean</span> isMerge = isMergedRegion(sheet, i, c.getColumnIndex());</span><br><span class="line">                    String data = <span class="string">""</span>;</span><br><span class="line">                    <span class="comment">//判断是否具有合并单元格</span></span><br><span class="line">                    <span class="keyword">if</span>(isMerge) &#123;</span><br><span class="line">                        data = getMergedRegionValue(sheet, row.getRowNum(), c.getColumnIndex());</span><br><span class="line">                    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                        data = c.getRichStringCellValue().toString();</span><br><span class="line">                    &#125;</span><br><span class="line">                    objs[objIdx++]=data;</span><br><span class="line">                &#125;</span><br><span class="line">                colIdx++;</span><br><span class="line">            &#125;</span><br><span class="line">            list.add(objs);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(list.size() == <span class="number">0</span>)&#123;</span><br><span class="line">            logger.warn(<span class="string">"excel sheet data is space"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取excel文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  wb</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> List&lt;List&lt;String[]&gt;&gt; &lt;br&gt;List&lt;String[]&gt;表示第i个sheet&lt;br&gt; String[]表示sheet某行</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;List&lt;String[]&gt;&gt; readExcel(Workbook wb) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 总sheet数</span></span><br><span class="line">        <span class="keyword">int</span> sheetNum = wb.getNumberOfSheets();</span><br><span class="line">        logger.info(<span class="string">"excel sheetNum is :"</span>+sheetNum);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 遍历sheet</span></span><br><span class="line">        List&lt;List&lt;String[]&gt;&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sheetNum ; i++) &#123;</span><br><span class="line">            Sheet sheet = wb.getSheetAt(i);</span><br><span class="line">            List&lt;String[]&gt; sheetData = readOneSheet(sheet);</span><br><span class="line">            list.addAll(Collections.singleton(sheetData));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 读取单个sheet数据，封装为List&lt;String[]&gt;&lt;br&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@warn</span> 可能会有全是空串的数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> List&lt;String[]&gt;,一个String[]是</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;String[]&gt; readOneSheet(Sheet sheet)&#123;</span><br><span class="line">        <span class="keyword">int</span> startRow = sheet.getFirstRowNum();</span><br><span class="line">        <span class="keyword">int</span> endRow = sheet.getLastRowNum();</span><br><span class="line">        logger.info(<span class="string">"sheet startRow:"</span>+startRow);</span><br><span class="line">        logger.info(<span class="string">"sheet endRow:"</span>+endRow);</span><br><span class="line">        List&lt;String[]&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">// 遍历行</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = startRow; i &lt;= endRow ; i++) &#123;</span><br><span class="line">            Row row = sheet.getRow(i);</span><br><span class="line">            <span class="keyword">if</span>(row == <span class="keyword">null</span>)&#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// int startColIdx = row.getFirstCellNum();</span></span><br><span class="line">            <span class="keyword">int</span> endColIdx = row.getLastCellNum();</span><br><span class="line">            String[] objs = <span class="keyword">new</span> String[endColIdx+<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> colIdx = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">// 遍历列</span></span><br><span class="line">            <span class="keyword">for</span> (Cell c : row) &#123;</span><br><span class="line">                c.setCellType(Cell.CELL_TYPE_STRING);</span><br><span class="line">                String data = <span class="string">""</span>;</span><br><span class="line">                <span class="keyword">boolean</span> isMerge = isMergedRegion(sheet, i, c.getColumnIndex());</span><br><span class="line">                <span class="comment">//判断是否具有合并单元格</span></span><br><span class="line">                <span class="keyword">if</span>(isMerge) &#123;</span><br><span class="line">                    data = getMergedRegionValue(sheet, row.getRowNum(), c.getColumnIndex());</span><br><span class="line">                &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                    data = c.getRichStringCellValue().toString();</span><br><span class="line">                &#125;</span><br><span class="line">                objs[colIdx]=data;</span><br><span class="line">                colIdx++;</span><br><span class="line">            &#125;</span><br><span class="line">            list.add(objs);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(list.size() == <span class="number">0</span>)&#123;</span><br><span class="line">            logger.warn(<span class="string">"excel sheet data is space"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取合并单元格的值&lt;br&gt;</span></span><br><span class="line"><span class="comment">     * 即获取合并单元格第一个cell的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> row</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> column</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getMergedRegionValue</span><span class="params">(Sheet sheet ,<span class="keyword">int</span> row , <span class="keyword">int</span> column)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获得一个 sheet 中合并单元格的数量</span></span><br><span class="line">        <span class="keyword">int</span> sheetMergeCount = sheet.getNumMergedRegions();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 遍历合并单元格</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; sheetMergeCount ; i++)&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 得出具体的合并单元格</span></span><br><span class="line">            CellRangeAddress ca = sheet.getMergedRegion(i);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 得到合并单元格的起始行, 结束行, 起始列, 结束列</span></span><br><span class="line">            <span class="keyword">int</span> firstColumn = ca.getFirstColumn();</span><br><span class="line">            <span class="keyword">int</span> lastColumn = ca.getLastColumn();</span><br><span class="line">            <span class="keyword">int</span> firstRow = ca.getFirstRow();</span><br><span class="line">            <span class="keyword">int</span> lastRow = ca.getLastRow();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取合并单元格第一个cell的值</span></span><br><span class="line">            <span class="keyword">if</span>(row &gt;= firstRow &amp;&amp; row &lt;= lastRow)&#123;</span><br><span class="line">                <span class="keyword">if</span>(column &gt;= firstColumn &amp;&amp; column &lt;= lastColumn)&#123;</span><br><span class="line">                    Row fRow = sheet.getRow(firstRow);</span><br><span class="line">                    Cell fCell = fRow.getCell(firstColumn);</span><br><span class="line">                    <span class="keyword">return</span> getCellValue(fCell) ;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断指定的单元格是否是合并单元格</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> row 行下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> column 列下标</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isMergedRegion</span><span class="params">(Sheet sheet,<span class="keyword">int</span> row ,<span class="keyword">int</span> column)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 得到一个sheet中有多少个合并单元格</span></span><br><span class="line">        <span class="keyword">int</span> sheetMergeCount = sheet.getNumMergedRegions();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; sheetMergeCount; i++) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 得出具体的合并单元格</span></span><br><span class="line">            CellRangeAddress range = sheet.getMergedRegion(i);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 得到合并单元格的起始行, 结束行, 起始列, 结束列</span></span><br><span class="line">            <span class="keyword">int</span> firstColumn = range.getFirstColumn();</span><br><span class="line">            <span class="keyword">int</span> lastColumn = range.getLastColumn();</span><br><span class="line">            <span class="keyword">int</span> firstRow = range.getFirstRow();</span><br><span class="line">            <span class="keyword">int</span> lastRow = range.getLastRow();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 判断该单元格是否在合并单元格范围之内, 如果是, 则返回 true</span></span><br><span class="line">            <span class="keyword">if</span>(row &gt;= firstRow &amp;&amp; row &lt;= lastRow)&#123;</span><br><span class="line">                <span class="keyword">if</span>(column &gt;= firstColumn &amp;&amp; column &lt;= lastColumn)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断sheet页中是否含有合并单元格</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">hasMerged</span><span class="params">(Sheet sheet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> sheet.getNumMergedRegions() &gt; <span class="number">0</span> ? <span class="keyword">true</span> : <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取单元格的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cell</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getCellValue</span><span class="params">(Cell cell)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(cell == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">switch</span> (cell.getCellType())&#123;</span><br><span class="line">            <span class="keyword">case</span> Cell.CELL_TYPE_STRING:</span><br><span class="line">                <span class="keyword">return</span> cell.getStringCellValue();</span><br><span class="line">            <span class="keyword">case</span> Cell.CELL_TYPE_BOOLEAN:</span><br><span class="line">                <span class="keyword">return</span> String.valueOf(cell.getBooleanCellValue());</span><br><span class="line">            <span class="keyword">case</span> Cell.CELL_TYPE_FORMULA:</span><br><span class="line">                <span class="keyword">return</span> cell.getCellFormula() ;</span><br><span class="line">            <span class="keyword">case</span> Cell.CELL_TYPE_NUMERIC:</span><br><span class="line">                <span class="keyword">return</span> String.valueOf(cell.getNumericCellValue());</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建工作簿</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> in</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Workbook <span class="title">createWorkBook</span><span class="params">(InputStream in)</span> <span class="keyword">throws</span> IOException, InvalidFormatException </span>&#123;</span><br><span class="line">        Workbook wb = WorkbookFactory.create(in);</span><br><span class="line">        <span class="keyword">return</span> wb;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取sheet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> wb</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheetIdx</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Sheet <span class="title">getSheetByIdx</span><span class="params">(Workbook wb, <span class="keyword">int</span> sheetIdx)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 总sheet数</span></span><br><span class="line">        <span class="keyword">int</span> sheetNum = wb.getNumberOfSheets();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// sheet不存在</span></span><br><span class="line">        <span class="keyword">if</span>(sheetIdx &lt; <span class="number">0</span> || sheetIdx &gt;= sheetNum)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取sheet</span></span><br><span class="line">        Sheet sheet = wb.getSheetAt(sheetIdx);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sheet;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*----------写excel相关----------*/</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 添加合并单元格</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> sheet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstRow 开始行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lastRow 结束行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> firstCol 开始列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> lastCol 结束列</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mergeRegion</span><span class="params">(Sheet sheet, <span class="keyword">int</span> firstRow, <span class="keyword">int</span> lastRow, <span class="keyword">int</span> firstCol, <span class="keyword">int</span> lastCol)</span> </span>&#123;</span><br><span class="line">        sheet.addMergedRegion(<span class="keyword">new</span> CellRangeAddress(firstRow, lastRow, firstCol, lastCol));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol></div><footer class="article-footer"><ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Excel/">Excel</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JAVA/">JAVA</a></li></ul><div style="text-align:center;color:#ccc;font-size:14px;margin-top:10px"> ------------- 本文结束&nbsp;<i class="fe fe-smile"></i>&nbsp;感谢您的阅读 -------------</div></footer></div><nav class="article-nav"> <a href="/2019/06/27/Maven简记/" class="article-nav-link"><strong class="article-nav-caption">前一篇</strong><div class="article-nav-title"> Maven简记</div></a> <a href="/2019/05/05/MySQLdb批量执行sql-TypeError-not-all-arguments-converted-during-string-formatting/" class="article-nav-link"><strong class="article-nav-caption">后一篇</strong><div class="article-nav-title">MySQLdb批量执行sql, TypeError: not all arguments converted during string formatting</div></a></nav><div class="comment_headling" style="margin-top:5rem"><font size="5"><i class="fe fe-comments"></i> 评论</font></div><div class="comment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="/js/Valine.min.js"></script><script type="text/javascript">GUEST_INFO=["nick","mail","link"],guest_info="nick,mail,link".split(",").filter(function(i){return-1<GUEST_INFO.indexOf(i)}),guest_info=0==guest_info.length?GUEST_INFO:guest_info,new Valine({av:AV,el:".comment",app_id:"fq4O7Xaf1cYDbADGellNEn6V-gzGzoHsz",app_key:"a626rNIHkVVk8tGBBCfaQjb9",placeholder:"记得留下你的昵称和邮箱...可以快速收到回复ヾﾉ≧∀≦)o",meta:guest_info,notify:!0,verify:!1,avatar:"monsterid",recordIP:!0,visitor:!1,lang:"zh-cn"})</script></article></section><footer class="footer"><div class="outer"><ul class="list-inline"><li>已分享 48 篇博文，累计 <span class="post-count">55.1k</span> 字</li><ul class="list-inline"><li><i class="fe fe-smile-alt"></i>&nbsp;访客数&emsp;<span id="busuanzi_value_site_uv"></span></li><li><i class="fe fe-bookmark"></i>&nbsp;文章访问量&emsp;<span id="busuanzi_value_page_pv"></span></li></ul></ul><ul class="list-inline"><li><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span></li><script>var now=new Date;function createtime(){var n=new Date("07/28/2019 10:02:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="已等候你 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script><ul class="list-inline"><li>&copy; 2019-2020 松林羊</li><li>Theme <a href="https://github.com/zhwangart/hexo-theme-ocean">Ocean</a></li></ul></ul></div></footer></main><aside class="sidebar sidebar-specter"> <button class="navbar-toggle"></button><nav class="navbar"><div class="logo"> <a href="/"><img id="andus-head-img" src="/images/head-nav.png" alt="松林羊"></a></div><ul class="nav nav-main"><li class="nav-item"> <a class="nav-item-link" href="/" target="_self">主页</a></li><li class="nav-item"> <a class="nav-item-link" href="/archives" target="_self">归档</a></li><li class="nav-item"> <a class="nav-item-link" href="/categories" target="_self">分类</a></li><li class="nav-item"> <a class="nav-item-link" href="/tags" target="_self">标签</a></li><li class="nav-item"> <a class="nav-item-link" href="/links" target="_self">友链</a></li><li class="nav-item"> <a class="nav-item-link">综合</a><ul class="nav nav-main nav2"><li class="nav-item li2"> <a class="nav-item-link-child" href="/resource" target="_self">资 源</a></li><li class="nav-item li2"> <a class="nav-item-link-child" href="/site" target="_self">网 站</a></li></ul></li><li class="nav-item"> <a class="nav-item-link">关于</a><ul class="nav nav-main nav2"><li class="nav-item li2"> <a class="nav-item-link-child" href="/me" target="_self">博 主</a></li><li class="nav-item li2"> <a class="nav-item-link-child" href="http://stars.andus.top/" target="_blank">记 录</a></li><li class="nav-item li2"> <a class="nav-item-link-child" href="/plan" target="_self">计 划</a></li></ul></li><li class="nav-item"> <a class="nav-item-link" href="http://resume.andus.top/" target="_blank">简 历</a></li><li class="nav-item"><a class="nav-item-link nav-item-search" title="搜索"><i class="fe fe-search"></i> 搜索</a></li></ul></nav><nav class="navbar navbar-bottom"><ul class="nav"><li class="nav-item"><div class="totop" id="totop"><i class="fe fe-rocket"></i></div></li><li class="nav-item"></li></ul></nav><div class="search-form-wrap"><div class="local-search local-search-plugin"> <input type="search" id="local-search-input" class="local-search-input" placeholder="Search..."><div id="local-search-result" class="local-search-result"></div></div></div></aside><script src="/js/jquery-2.0.3.min.js"></script><script src="/js/jquery.justifiedGallery.min.js"></script><script src="/js/lazyload.min.js"></script><script src="/js/busuanzi-2.3.pure.min.js"></script><script src="/fancybox/jquery.fancybox.min.js"></script><script src="/js/tocbot.min.js"></script><script>900<=document.body.clientWidth&&tocbot.init({tocSelector:".tocbot",contentSelector:".article-entry",headingSelector:"h1, h2, h3, h4, h5, h6",hasInnerContainers:!0,scrollSmooth:!0,positionFixedSelector:".tocbot",positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto"})</script><script src="/js/ocean.js"></script><script src="/js/andus.js"></script><script src="/js/love.js"></script><script>$("img:not(#andus-head-img)").each(function(){$(this).wrap('<a class="fancybox" data-fancybox="gallery" href="'+$(this).prop("src")+'"></a>')})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"/live2dw/assets/haruto.model.json"},display:{superSample:2,width:150,height:300,position:"left",hOffset:0,vOffset:-20},mobile:{show:!1},react:{opacityDefault:.5,opacityOnHover:.2},log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})</script></body>